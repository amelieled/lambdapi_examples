require open AL_library.Notation
require open AL_library.Bool
require open AL_library.Constructive_logic

///////////////////////////////////////
// Definitions of type
///////////////////////////////////////
constant symbol rgb : Set
constant symbol RGB : TYPE
rule Ï„ rgb â†ª RGB
constant symbol red   : RGB
constant symbol green : RGB
constant symbol blue  : RGB

// Induction principle on RGB.
symbol rgb_ind :
   Î p, Ï€ (p red) â†’ Ï€ (p green) â†’ Ï€ (p blue) â†’ Î c, Ï€ (p c)

constant symbol color : Set
constant symbol C : TYPE
rule Ï„ color â†ª C
constant symbol black : C
constant symbol white : C
constant symbol primary : RGB â†’ C

// Induction principle on C.
symbol color_ind : Î p, Ï€ (p black) â†’ Ï€ (p white) â†’ (Î n, Ï€ (p (primary n))) â†’ Î c, Ï€ (p c)

//////////////////////////////////////////
// Some functions
//////////////////////////////////////////

symbol black_or_white : C â†’ ğ”¹
rule black_or_white black     â†ª true
 with black_or_white white     â†ª true
 with black_or_white (primary _) â†ª false

symbol isred : C â†’ ğ”¹
rule isred black       â†ª false
 with isred white       â†ª false
 with isred (primary red) â†ª true
 with isred (primary green) â†ª false
 with isred (primary blue) â†ª false

symbol isgreen : C â†’ ğ”¹
rule isgreen black       â†ª false
 with isgreen white       â†ª false
 with isgreen (primary red) â†ª false
 with isgreen (primary green) â†ª true
 with isgreen (primary blue) â†ª false
                           
symbol isblue : C â†’ ğ”¹
rule isblue black       â†ª false
 with isblue white       â†ª false
 with isblue (primary red) â†ª false
 with isblue (primary green) â†ª false
 with isblue (primary blue) â†ª true

theorem left_rgb : Î n,
Ï€ (black_or_white (primary n) = false âŠƒ isred (primary n) = true âˆ¨ isgreen (primary n) = true âˆ¨ isblue (primary n) = true)
proof
  assume n
  refine rgb_ind (Î»z, black_or_white (primary z) = false âŠƒ
                      isred (primary z) = true âˆ¨ isgreen (primary z) = true
                      âˆ¨ isblue (primary z) = true) _ _ _ n
  // Goal red
  simpl
admit
