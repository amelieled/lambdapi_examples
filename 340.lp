require open amelie.Notation
require open amelie.Bool
require open amelie.Logic

///////////////////////////////////////
// Definitions of type
///////////////////////////////////////
constant symbol rgb : Set
constant symbol RGB : TYPE
rule Ï„ rgb â†’ RGB
constant symbol red   : RGB
constant symbol green : RGB
constant symbol blue  : RGB

// Induction principle on RGB.
symbol rgb_ind :
   âˆ€p, Ï€ (p red) â‡’ Ï€ (p green) â‡’ Ï€ (p blue) â‡’ âˆ€c, Ï€ (p c)

constant symbol color : Set
constant symbol C : TYPE
rule Ï„ color â†’ C
constant symbol black : C
constant symbol white : C
constant symbol primary : RGB â‡’ C

// Induction principle on C.
symbol color_ind : âˆ€p, Ï€ (p black) â‡’ Ï€ (p white) â‡’ (âˆ€n, Ï€ (p (primary n))) â‡’ âˆ€c, Ï€ (p c)

//////////////////////////////////////////
// Some functions
//////////////////////////////////////////

symbol black_or_white : C â‡’ ğ”¹
rule black_or_white black     â†’ true
 and black_or_white white     â†’ true
 and black_or_white (primary _) â†’ false

symbol isred : C â‡’ ğ”¹
rule isred black       â†’ false
 and isred white       â†’ false
 and isred (primary red) â†’ true
 and isred (primary green) â†’ false
 and isred (primary blue) â†’ false

symbol isgreen : C â‡’ ğ”¹
rule isgreen black       â†’ false
 and isgreen white       â†’ false
 and isgreen (primary red) â†’ false
 and isgreen (primary green) â†’ true
 and isgreen (primary blue) â†’ false
                           
symbol isblue : C â‡’ ğ”¹
rule isblue black       â†’ false
 and isblue white       â†’ false
 and isblue (primary red) â†’ false
 and isblue (primary green) â†’ false
 and isblue (primary blue) â†’ true

theorem left_rgb : âˆ€n,
Ï€ (black_or_white (primary n) = false âŠƒ isred (primary n) = true âˆ¨ isgreen (primary n) = true âˆ¨ isblue (primary n) = true)
proof
  assume n
  refine rgb_ind (Î»z, black_or_white (primary z) = false âŠƒ
                      isred (primary z) = true âˆ¨ isgreen (primary z) = true
                      âˆ¨ isblue (primary z) = true) _ _ _ n
  // Goal red
  simpl
admit
